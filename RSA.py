# -----BEGIN PUBLIC KEY-----
# MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+7+
# /AvKr1rzQczdAgMBAAE=
# -----END PUBLIC KEY-----


# key长度：256
# 模数：C0332C5C64AE47182F6C1C876D42336910545A58F7EEFEFC0BCAAF5AF341CCDD
# 指数：65537 (0x10001)

# 将n转成10进制：86934482296048119190666062003494800588905656017203025617216654058378322103517
# 将n分解成pq
# p = 285960468890451637935629440372639283459
# q = 304008741604601924494328155975272418463


import rsa
import gmpy2
e = 65537
n = 86934482296048119190666062003494800588905656017203025617216654058378322103517
p = 285960468890451637935629440372639283459
q = 304008741604601924494328155975272418463
fn = (p-1)*(q-1)
d = int(gmpy2.invert(e,fn))
key = rsa.PrivateKey(n,e,d,q,p)         #在pkcs标准中,pkcs#1规定,私钥包含(n,e,d,p,q)
with open("E:/Crypto/Crypto_Problem/RSA_2/flag.enc","rb") as f:
    f = f.read()
    print(rsa.decrypt(f,key))
